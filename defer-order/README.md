# defer-order
데이터베이스나 TCP 연결을 맺은 후 연결을 종료하려면 연결을 닫도록 해야하는데 Go에서는 이를 간편하게 하기 위해 defer 문법을 제공하고 있다.

연결 후 바로 아래 defer 연결 종료 함수를 호출하면 함수 종료 시점에 알아서 실행해주기 때문에 종료하는 것을 잊지 않고 실행할 수 있다.

defer를 여러개 실행하는 경우 어떤 순서로 진행될지 궁금해서 해본 실험

# 결론
기본적으로 defer 함수를 호출한 순서의 역순으로 실행

1, 2, 3, 4, 5 순으로 defer 함수를 실행한 경우 종료 시점에 5, 4, 3, 2, 1 순으로 실행됨

defer에서 고루틴은 직접 호출이 안되기 때문에 클로저(closure)를 이용해서 고루틴으로 호출하며
이때 고루틴 내부에서 별도로 순서를 보장하는 코드가 있지 않는 이상, 순서는 보장되지 않음

추가로 for-loop 내부에 고루틴으로 돌아가는 클로저를 호출하거나 defer로 함수를 호출하는 경우, 1.21 이하 Go에서는 for-loop의 마지막 값으로만 표시되는 문제가 존재
